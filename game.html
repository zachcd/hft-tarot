<!--
/*
Description of code: Dealing cards, points, and game rules
 */
-->
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title> French Tarot</title>
  <style>
     body {
         margin: 0;
     }
  </style>
</head>
<body>
Waiting for player
</body>
<script> //defines that there is javascript inside
const happyfuntimes = require('happyfuntimes'); // imports the library of happyfuntimes
import tarotDeck from './tarotDeck.js'

const globals = { // globals is the state of the game, where you store things other parts of the game need access to
  playerId: 0,
  players: [],
  currentlyPlaying: false,
  disconnected: []
};

function randInt(min, max) { // random number generator
  if (max === undefined) {
    max = min;
    min = 0;
  }
  return Math.random() * (max - min) + min | 0;
}



class Player {
  constructor(netPlayer, name) { //making new instances of the class, contructor calls the function to set it up
    this.netPlayer = netPlayer;
    this.name = name;


    netPlayer.addEventListener('disconnect', Player.prototype.disconnect.bind(this));

  }

  disconnect() {
    const ndx = globals.players.indexOf(this); //index of takes the array and searches through it to find the index for the player
    if (ndx >= 0) {
      globals.players.splice(ndx, 1); //splice is removing
    }
  }

}

class TarotGame {
  constructor(players) {
    this.deck = shuffle(tarotDeck)
    this.doggo = []//deck is 78
    this.players = players
    
  }
}

function shuffle(array) {
  var m = array.length, t, i;

  // While there remain elements to shuffle…
  while (m) {

    // Pick a remaining element…
    i = Math.floor(Math.random() * m--);

    // And swap it with the current element.
    t = array[m];
    array[m] = array[i];
    array[i] = t;
  }

  return array;
}

const server = new happyfuntimes.GameServer();

// A new player has arrived.
server.on('playerconnect', function(netPlayer) {
  let newPlayer = new Player(netPlayer, "Player" + (++globals.playerId))
  globals.players.push(newPlayer);
  if (globals.players.length == 4) {
    if (globals.currentlyPlaying) {//if a boolean, autuomatically checks if true or not, if statements can only undertand T/F
      reconnect(newPlayer, globals.disconnected)
    } else {
      startGame ()
    }
  }
});

function reconnect(player,disconnects) {

}

function startGame() {
  globals.currentlyPlaying = true
}

</script>
</html>
